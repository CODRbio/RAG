{
  "database": {
    "url": "sqlite:///data/rag.db",
    "echo": false
  },
  "llm": {
    "default": "deepseek", 
    "dry_run": false,
    "platforms": {
      "openai": {
        "api_key": "sk-xxx",
        "base_url": "https://api.openai.com/v1"
      },
      "deepseek": {
        "api_key": "sk-xxx",
        "base_url": "https://api.deepseek.com/v1"
      },
      "gemini": {
        "api_key": "AIzxxx",
        "base_url": "https://generativelanguage.googleapis.com/v1beta/openai"
      },
      "claude": {
        "api_key": "sk-ant-xxx",
        "base_url": "https://api.anthropic.com"
      },
      "kimi": {
        "api_key": "sk-xxx",
        "base_url": "https://api.moonshot.ai/v1"
      },
      "perplexity": {
        "api_key": "",
        "base_url": "https://api.perplexity.ai"
      },
      "qwen": {
        "api_key": "sk-xxx",
        "base_url": "https://dashscope.aliyuncs.com/compatible-mode/v1"
      }
    },
    "_providers_note": "模型列表由前端实时从平台 API 拉取。default_model 仅在无 UI 选择时托底。params 用于 thinking 等参数注入。",
    "providers": {
      "openai":           { "platform": "openai",     "default_model": "gpt-5.2"                },
      "openai-thinking":  { "platform": "openai",     "default_model": "gpt-5.2",               "params": { "reasoning_effort": "high" } },
      "openai-mini":      { "platform": "openai",     "default_model": "gpt-5-mini"            },
      "deepseek":         { "platform": "deepseek",   "default_model": "deepseek-chat"          },
      "deepseek-thinking":{ "platform": "deepseek",   "default_model": "deepseek-reasoner",     "params": { "thinking": { "type": "enabled" } } },
      "gemini":           { "platform": "gemini",     "default_model": "gemini-3.1-pro-preview" },
      "gemini-thinking":  { "platform": "gemini",     "default_model": "gemini-3.1-pro-preview","params": { "reasoning_effort": "high" } },
      "gemini-vision":    { "platform": "gemini",     "default_model": "gemini-3.1-pro-preview","params": { "temperature": 0.2 } },
      "gemini-flash":     { "platform": "gemini",     "default_model": "gemini-flash-latest"   },
      "claude":           { "platform": "claude",     "default_model": "claude-sonnet-4-6"      },
      "claude-thinking":  { "platform": "claude",     "default_model": "claude-sonnet-4-6",     "params": { "thinking": { "type": "enabled", "budget_tokens": 10000 } } },
      "claude-haiku":     { "platform": "claude",     "default_model": "claude-haiku-4-5"      },
      "kimi":             { "platform": "kimi",       "default_model": "kimi-k2.5"              },
      "kimi-vision":      { "platform": "kimi",       "default_model": "kimi-k2.5"              },
      "kimi-thinking":    { "platform": "kimi",       "default_model": "kimi-k2.5",             "params": { "thinking": { "type": "enabled" } } },
      "sonar":            { "platform": "perplexity", "default_model": "sonar-pro"               },
      "qwen":             { "platform": "qwen",       "default_model": "qwen3.5-plus"            },
      "qwen-vision":      { "platform": "qwen",       "default_model": "qwen3.5-plus"            },
      "qwen-thinking":    { "platform": "qwen",       "default_model": "qwen3.5-plus",           "params": { "enable_thinking": true } }
    }
  },
  "parser": {
    "version": "1.0.0",
    "docling_ocr": false,
    "column_gap_min_ratio": 0.02,
    "column_gap_max_ratio": 0.15,
    "gravity_max_v_down_ratio": 0.06,
    "gravity_min_x_overlap": 0.30,
    "gravity_cross_page_penalty": 0.20,
    "caption_patterns": ["^(Fig\\.|Figure)\\s*\\d+", "^图\\s*\\d+"],
    "table_title_patterns": ["^Table\\s*\\d+", "^Tab\\.\\s*\\d+", "^表\\s*\\d+"],
    "table_footnote_patterns": ["^Note:", "^\\*", "^注[：:]", "^Source:"],
    "llm_text_provider": "deepseek",
    "llm_vision_provider": "gemini-vision",
    "llm_text_model": null,
    "llm_vision_model": null,
    "llm_vision_concurrency": 1,
    "llm_text_max_tokens": 800,
    "llm_vision_max_tokens": 1536,
    "llm_json_repair_max_tokens": 1024,
    "llm_temperature": 0.1,
    "llm_max_retries": 2,
    "enrich_tables": true,
    "enrich_figures": true
  },
  "chunk": {
    "target_chars": 1000,
    "min_chars": 200,
    "max_chars": 1800,
    "overlap_sentences": 2,
    "table_rows_per_chunk": 10
  },
  "search": {
    "top_k": 20,
    "rerank_top_k": 20,
    "rrf_k": 60,
    "dense_recall_k": 80,
    "sparse_recall_k": 80,
    "rrf_dense_weight": 0.6,
    "rrf_sparse_weight": 0.4,
    "rerank_input_k": 100,
    "rerank_output_k": 20,
    "per_doc_cap": 5,
    "reranker_mode": "cascade",
    "use_colbert_reranker": true,
    "colbert_model": "jinaai/jina-colbert-v2",
    "colbert_top_k": 30,
    "chat_gap_ratio": 0.2,
    "research_gap_ratio": 0.25,
    "chat_rank_pool_multiplier": 3.0,
    "research_rank_pool_multiplier": 3.0
  },
  "web_search": {
    "enabled": true,
    "provider": "tavily",
    "api_key": "",
    "search_depth": "advanced",
    "max_results": 5,
    "include_answer": true,
    "include_domains": [],
    "exclude_domains": [],
    "enable_query_optimizer": true,
    "enable_query_expansion": false,
    "query_expansion_llm": "deepseek",
    "max_queries": 4,
    "smart_optimizer": {
      "enabled": true,
      "llm_provider": "deepseek",
      "max_queries_per_provider": 3,
      "enable_bilingual": true,
      "fallback_to_simple": true
    }
  },
  "google_search": {
    "enabled": true,
    "scholar_enabled": true,
    "google_enabled": false,
    "extension_path": "extra_tools/CapSolverExtension",
    "headless": null,
    "proxy": null,
    "timeout": 60000,
    "max_results": 5,
    "user_data_dir": null
  },
  "serpapi": {
    "enabled": false,
    "api_key": "",
    "max_results": 10,
    "timeout_seconds": 30
  },
  "semantic_scholar": {
    "enabled": false,
    "api_key": "",
    "base_url": "https://ai4scholar.net/graph/v1",
    "max_results": 5,
    "timeout_seconds": 30
  },
  "ncbi": {
    "enabled": true,
    "api_key": "",
    "max_results": 5,
    "timeout_seconds": 20,
    "cache_ttl_seconds": 3600,
    "cache_maxsize": 256
  },
  "content_fetcher": {
    "enabled": false,
    "only_academic": false,
    "max_content_length": 8000,
    "timeout_seconds": 15,
    "brightdata_api_key": "",
    "brightdata_zone": "",
    "cache_enabled": true,
    "cache_ttl_seconds": 3600,
    "disk_cache_enabled": true,
    "disk_cache_ttl_seconds": 2592000,
    "disk_cache_promote_threshold": 3,
    "disk_cache_dir": "data/cache",
    "max_concurrent": 5,
    "compress_long_fulltext": true,
    "compress_word_threshold": 300,
    "compress_max_output_words": 400
  },
  "api": {
    "host": "127.0.0.1",
    "port": 9999
  },
  "auth": {
    "secret_key": "change-me-in-local",
    "token_expire_hours": 24,
    "admin_username": "admin",
    "admin_default_password": "admin123"
  },
  "logging": {
    "level": "INFO",
    "max_size_mb": 100,
    "max_age_days": 30,
    "min_keep_mb": 20,
    "console_output": true
  },
  "storage": {
    "max_age_days": 30,
    "max_size_gb": 5,
    "cleanup_on_startup": true,
    "cleanup_batch_size": 100
  },
  "citation": {
    "key_format": "author_date",
    "hash_length": 12,
    "author_date_max_authors": 2,
    "merge_level": "document"
  },
  "deep_research": {
    "default_depth": "comprehensive",
    "depth_presets": {
      "lite": {
        "max_iterations_per_section": 3,
        "max_section_research_rounds": 3,
        "coverage_threshold": 0.60,
        "recall_queries_per_section": 2,
        "precision_queries_per_section": 2,
        "search_top_k_first": 18,
        "search_top_k_gap": 10,
        "search_top_k_eval": 20,
        "search_top_k_write": 10,
        "verification_k": 12,
        "self_correction_trigger_coverage": 0.75,
        "self_correction_min_round": 3,
        "search_top_k_gap_decay_factor": 0.60,
        "search_top_k_gap_min": 6,
        "coverage_plateau_floor": 0.70,
        "coverage_plateau_min_gain": 0.03,
        "verify_light_threshold": 0.20,
        "verify_medium_threshold": 0.40,
        "verify_severe_threshold": 0.45,
        "review_gate_max_rounds": 80,
        "review_gate_base_sleep": 2,
        "review_gate_max_sleep": 15,
        "review_gate_early_stop_unchanged": 8,
        "recursion_limit": 200,
        "cost_warn_steps": 120,
        "cost_force_summary_steps": 180,
        "cost_tick_interval": 25
      },
      "comprehensive": {
        "max_iterations_per_section": 6,
        "max_section_research_rounds": 5,
        "coverage_threshold": 0.80,
        "recall_queries_per_section": 4,
        "precision_queries_per_section": 4,
        "search_top_k_first": 30,
        "search_top_k_gap": 15,
        "search_top_k_eval": 40,
        "search_top_k_write": 12,
        "verification_k": 16,
        "self_correction_trigger_coverage": 0.78,
        "self_correction_min_round": 3,
        "search_top_k_gap_decay_factor": 0.70,
        "search_top_k_gap_min": 8,
        "coverage_plateau_floor": 0.78,
        "coverage_plateau_min_gain": 0.02,
        "verify_light_threshold": 0.15,
        "verify_medium_threshold": 0.30,
        "verify_severe_threshold": 0.35,
        "review_gate_max_rounds": 200,
        "review_gate_base_sleep": 2,
        "review_gate_max_sleep": 20,
        "review_gate_early_stop_unchanged": 12,
        "recursion_limit": 500,
        "cost_warn_steps": 300,
        "cost_force_summary_steps": 420,
        "cost_tick_interval": 30
      }
    }
  },
  "graph": {
    "entity_extraction": {
      "strategy": "gliner",
      "fallback": "rule",
      "ontology_path": "config/ontology.json",
      "gliner": {
        "model": "urchade/gliner_base",
        "threshold": 0.4,
        "device": "cpu"
      },
      "llm": {
        "provider": "deepseek",
        "max_tokens": 1000
      }
    }
  },
  "auto_complete": {
    "enabled": true,
    "max_sections": 6,
    "max_words_per_section": 500,
    "include_abstract": true,
    "default_search_mode": "hybrid"
  },
  "performance": {
    "retrieval": {
      "timeout_seconds": 60,
      "web_soft_wait_seconds": 500,
      "cache_enabled": false,
      "cache_ttl_seconds": 3600,
      "parallel_dense_sparse": true,
      "max_workers": 4
    },
    "llm": {
      "timeout_seconds": 120,
      "max_retries": 2,
      "retry_backoff": 1.5,
      "cache_enabled": false,
      "cache_ttl_seconds": 3600,
      "max_concurrent_per_provider": 5
    },
    "web_search": {
      "timeout_seconds": 30,
      "cache_enabled": false,
      "cache_ttl_seconds": 3600
    },
    "unified_web_search": {
      "max_parallel_providers": 3,
      "per_provider_timeout_seconds": 30,
      "browser_providers_max_parallel": 1
    },
    "google_search": {
      "browser_reuse": true,
      "max_idle_seconds": 300,
      "max_pages_per_browser": 10,
      "cache_enabled": false,
      "cache_ttl_seconds": 1800
    }
  }
}