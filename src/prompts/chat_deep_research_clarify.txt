The user wants to conduct deep research. Generate clarification questions first:
- At least 1 question (even if the topic is clear, include 1 key confirmation question);
- If the topic is ambiguous or broad, generate more questions (up to 6);
- Questions should be sorted by priority.
Then output a structured research brief.

User's topic: "{message}"

Conversation history:
{history_block}

{language_instruction}

Generate questions to clarify (priority from high to low):
1. Precise scope of the research topic
2. Key focus areas (e.g. theoretical mechanisms, experimental methods, or applications)
3. Target audience and writing style (academic paper / popular science / report)
4. Length and depth requirements
5. Sub-topics to emphasize or exclude
6. Literature language preference

Constraints:
- Number of questions must be between 1 and 6
- Questions should be specific, answerable, and non-repetitive

Return JSON format:
{{
  "suggested_topic": "Suggested review topic (one sentence)",
  "suggested_outline": ["Section 1", "Section 2", ...],
  "research_brief": {{
    "scope": "Research scope description",
    "success_criteria": ["criterion 1", "criterion 2"],
    "key_questions": ["key question 1", "key question 2"],
    "exclusions": ["out-of-scope content"],
    "time_range": "literature time range",
    "source_priority": ["peer-reviewed papers", "reviews"]
  }},
  "questions": [
    {{"id": "q1", "text": "Question text", "type": "text", "default": "Suggested answer"}},
    {{"id": "q2", "text": "Question text", "type": "choice", "options": ["Option A", "Option B"], "default": "Option A"}}
  ]
}}

Return ONLY JSON, no other text.
